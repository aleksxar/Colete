<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üì¶ Colete</title>
<style>
:root {
    --bg: #1c1b22;
    --surface: #2a2a33;
    --border: #444;
    --text: #eee;
    --muted: #aaa;
    --primary: #005dc1;
    --primary-hover: #004288;
    --secondary: #11842c;
    --secondary-hover: #0c581c;
    --danger: #8c1924;
    --danger-hover: #6d1821;
    --radius: 8px;
    --transition: all 0.3s ease;
}

* { box-sizing: border-box; margin:0; padding:0; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height:1.6;
    padding:20px;
}

main {
    max-width:900px;
    margin:20px auto;
    display:grid;
    gap:2rem;
}

label { display:block; margin-bottom:0.5rem; font-weight:500; color: var(--muted); }

input, select {
    width:100%;
    padding:12px;
    font-size:16px;
    color: var(--text);
    background: var(--surface);
    border:none;
    border-bottom:2px solid var(--border);
    transition: var(--transition);
}

input:focus, select:focus { border-bottom-color: var(--primary); outline:none; }

select {
    appearance:none;
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23aaa' class='bi bi-chevron-down' viewBox='0 0 16 16'%3E%3Cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");
    background-repeat:no-repeat;
    background-position:right 1rem center;
    background-size:16px;
}

#packageList option[value=""] { font-weight:bold; color:var(--muted); }

.inputs-grid, .buttons-grid { display:grid; gap:1rem; margin-top:1rem; }
.inputs-grid { grid-template-columns: 1fr 1fr; }
.buttons-grid { grid-template-columns: 1fr 1fr 1fr; margin-top:1.5rem; }

.btn {
    padding:12px;
    font-size:16px;
    font-weight:600;
    border:none;
    border-radius: var(--radius);
    cursor:pointer;
    transition: var(--transition);
}
.btn:hover { opacity:0.9; transform:scale(1.03); }
.btn:active { transform:scale(0.98); }

#newBtn { background:var(--secondary); color:white; }
#newBtn:hover { background:var(--secondary-hover); }
#deleteBtn { background:var(--danger); color:white; }
#deleteBtn:hover { background:var(--danger-hover); }
#saveBtn { background:var(--primary); color:white; }
#saveBtn:hover { background:var(--primary-hover); }

iframe {
    width:100%; height:300px;
    border:none;
    border-radius: var(--radius);
    background: var(--surface);
}

@media(max-width:768px) {
    body { padding:10px; }
    main { margin:10px auto; gap:1.5rem; }
    .inputs-grid, .buttons-grid { grid-template-columns:1fr; }
}
</style>
</head>
<body>

<main>
<div>
    <label for="packageList">üíæ Colete salvate</label>
    <select id="packageList">
        <option value="">üìç Colet nou</option>
    </select>

    <div class="inputs-grid">
        <div>
            <label for="packageNameInput">üè∑Ô∏è Nume colet</label>
            <input type="text" id="packageNameInput" placeholder="Scrie numele coletului">
        </div>
        <div>
            <label for="trackingCodeInput">üöö Cod AWB</label>
            <input type="text" id="trackingCodeInput" placeholder="Scrie AWB-ul">
        </div>
    </div>

    <div class="buttons-grid">
        <button id="newBtn" class="btn">‚ú≥Ô∏è Nou</button>
        <button id="deleteBtn" class="btn">üåπ »òtergere</button>
        <button id="saveBtn" class="btn">üí† Salvare</button>
    </div>
</div>

<iframe id="trackerFrame" title="Package tracking widget"
src="https://postal.ninja/widget/tracker?lc=ro&inpText=AWB&btnText=üëÄ UrmƒÉre»ôte coletul&btnColor=%232596be&btnIcon=false&font=sans-serif&btnFont=sans-serif&noSave=true&theme=dark">
</iframe>
</main>

<script>
const packageList = document.getElementById('packageList'),
      nameInput = document.getElementById('packageNameInput'),
      codeInput = document.getElementById('trackingCodeInput'),
      trackerFrame = document.getElementById('trackerFrame'),
      newBtn = document.getElementById('newBtn'),
      deleteBtn = document.getElementById('deleteBtn'),
      saveBtn = document.getElementById('saveBtn');

const baseUrl = "https://postal.ninja/widget/tracker?lc=ro&inpText=AWB&btnText=üëÄ UrmƒÉre»ôte coletul&btnColor=%232596be&btnIcon=false&font=sans-serif&btnFont=sans-serif&noSave=true&theme=dark";
let packages = {};

function load() { packages = JSON.parse(localStorage.getItem('myPackages')) || {}; }
function save() { localStorage.setItem('myPackages', JSON.stringify(packages)); }

function populate(selected='') {
    while(packageList.options.length>1) packageList.remove(1);
    Object.keys(packages).sort().forEach(name=>{
        const opt=document.createElement('option');
        opt.value=name; opt.textContent=name;
        packageList.appendChild(opt);
    });
    packageList.value = Object.keys(packages).includes(selected)? selected : "";
}

function updateFrame(code='') { trackerFrame.src = code ? `${baseUrl}&tc=${code}` : baseUrl; }

function selectChange() {
    const name = packageList.value;
    if(name){
        nameInput.value=name;
        codeInput.value=packages[name];
        updateFrame(packages[name]);
        localStorage.setItem('lastSelectedPackage', name);
    } else {
        nameInput.value=''; codeInput.value=''; updateFrame();
        localStorage.removeItem('lastSelectedPackage');
    }
}

function newPackage() { packageList.value=''; selectChange(); }

function savePackage() {
    const oldName = packageList.value,
          newName = nameInput.value.trim(),
          code = codeInput.value.trim();

    if(!newName || !code){ alert("Introduce»õi un nume »ôi un cod AWB."); return; }
    if(oldName && oldName!==newName && packages[newName]){ alert(`Un colet numit "${newName}" deja existƒÉ.`); return; }
    if(oldName && oldName!==newName) delete packages[oldName];
    packages[newName]=code;
    save(); populate(newName); selectChange();
}

function deletePackage() {
    const name=packageList.value;
    if(!name){ alert("SelecteazƒÉ un colet din listƒÉ."); return; }
    if(confirm(`Sigur vrei sƒÉ »ôtergi "${name}"?`)){ delete packages[name]; save(); populate(); selectChange(); }
}

function init() {
    packageList.addEventListener('change', selectChange);
    codeInput.addEventListener('input', ()=>updateFrame(codeInput.value.trim()));
    newBtn.addEventListener('click', newPackage);
    saveBtn.addEventListener('click', savePackage);
    deleteBtn.addEventListener('click', deletePackage);

    load();
    populate(localStorage.getItem('lastSelectedPackage') || '');
    selectChange();
}

document.addEventListener('DOMContentLoaded', init);
</script>

</body>
</html>
